## Задачи с нефиксированной длительностью процесса

## Постановка задачи, отличия от постановки с фиксированным временем окончания

Введем несколько изменений в поставку задачи 1.
**A.** Будем считать, что $t_s$ задано, а $t_f$ заранее неизвестно и определяется следующим образом:

$$ \forall t < t_f \quad x(t) \notin X^f, \enspace x(t_f) \in X^f. $$
При этом для заданного начального состояния $x$ при разных управлениях $u(t)$ время $t_f$ достижения финального множества $X^f$ может быть различным.

**B.** Будем рассматривать только те задачи, в которых $U, f$ и $q$ автономны, т. е. не зависят от времени явно:

$${\begin{gathered}
x(t+1) = f(x(t), u(t)), \\
u(t) \in U(x(t)).
\end{gathered}}$$
$q(x(t), u(t))$ - затраты на шаге.

**C.** Также будем считать, что в пространстве состояний динамической системы нет циклических траекторий.

Вместо функции Беллмана введем некоторую оценку сверху этой функции - $\hat{S}(x)$ (верхняя оценка функции оптимальных затрат по попаданию в $X^f$ из $x$).

## Обобщение уравнений Беллмана на задачи с нефиксированной длительностью процесса

Запишем аналог рекуррентных соотношений. Пусть $Y_o = X^f$, $Y_1$ - множество состояний, из которых можно за один шаг попасть в $Y_0$. Далее, пусть $Y_{k+1}$ - множество состояний, из которых можно за один шаг попасть в $Y_k$. Причем, $Y_i$ и $Y_j$ можем пересекаться при $i \neq j$.

На первом шаге $(k = 0)$

$${\hat{S}(x) = \left\lbrace \begin{array}{rcl}
0, \enspace x \in Y_0 = X^f,\\
\infty, \enspace x \notin Y_0 = X^f.
\end{array}\right\rbrace}$$
Пусть уже выполнено $k$ итераций. Опишем $(k+1)$-ю. Рассматриваются $x \in Y_{k+1}$. Значения $\hat{S}(x)$ в правой части сл. равенства определяют оптимальные затраты по переходу из $x$ в $X^f$ не более, чем за $k$ шагов. 

$${\hat{S}(x) \coloneqq \min\left\lbrace \begin{array}{rcl}
\hat{S}(x); \enspace \min_
{\substack{u \in U(x) \\ f(x,u) \in Y_k}}
{\{q(x,u) + \hat{S}(f(x,u))\}}
\end{array}\right\rbrace}.$$

Знак $\coloneqq$ подчеркивает, что слева от него подразумевается новый экземпляр функции $\hat{S}$, который должен заменить "старый" экземпляр этой функции только после завершения формирования нового экземпляра. В процессе вычислений запоминаются значения $u^*(x)$, приведшие к улучшению $\hat{S}(x)$. Процесс закончен, когда $Y_{k+1} = \emptyset$. В этот момент $\hat{S}(x)$ определяет оптимальные затраты по достижению $X^f$ из $x$, т. е. становится функцией Беллмана. После этого определяется оптимальное начальное состояние $x^*_s = \arg{\min_{x \in X^s}{\hat{S}(x)}}$.

## Применение к задачам поиска оптимальных путей на графах

Пусть $X$ — конечное множество состояний автономной управляемой динамической системы, $u$ — управление, принимающее в каждом из состояний значения из конечного множества $U(x)$, а $\hat{x} = f(x,u)$ — уравнение данной динамической системы, определяющее состояние $\hat{x}$, в которое перейдёт система из состояния $x$ при выборе управления $u$. На данном переходе определяется функция затрат $C(x,u)=(C_1(x,u), \ldots, C_m(x,u))$. Кроме того, задаются возможные начальные и конечные состояния динамического процесса, образующие множества $X^S$ и $X^F$.

Задачи такого типа могут быть легко представлены в форме задач оптимизации на графах. Для этого достаточно интерпретировать каждое из состояний $x$ динамической системы как вершину некоторого графа, а переходы $\hat{x} = f(x,u)$, как его ориентированные рёбра $g=g(x,u,\hat{x}$, снабжённые весами $C(g)=C(x,u)$.

Пусть дан граф $<X,G,X^S,X^F>$ с множеством начальных вершин $X^S$ и конечных $X^F$, а $\Gamma(x^s,x^f)$ — множество путей $\gamma = \gamma (x^s,x^f)$ в графе, соединяющих эти вершины. Критерий качества пути можно определить различным образом. Рассмотрим два вида критериев $w(\gamma) = (w_1(\gamma), \ldots, w_m(\gamma))$:

$$
	w_i(\gamma)= \sum_{g \in \gamma}{C_i(g)} \quad (i=1,..m)
$$
или
$$
	w_i(\gamma)= \max_{g \in \gamma}{C_i(g)} \quad (i=1,..m)
$$

Задача оптимизации с векторным критерием принимает вид
$$w(\gamma) \rightarrow \min, \enspace
\gamma \in \{ \gamma \in \Gamma(x^s,x^f): x^s \in X^S, x^f \in X^F\}.$$

## Задачи поиска оптимальных путей на графах с неотрицательными весами ребер: алгоритм метода Дейкстры, доказательство оптимальности построенных им путей (по материалам лабораторной работы), связь метода Дейкстры с принципом Беллмана в форме достаточного условия

### АЛГОРИТМ МЕТОДА ДЕЙКСТРЫ

ШАГ 0 – *начальные операции*. Вершине $x^s$ приписывается нулевая метка, которая считается постоянной, всем остальным вершинам — бесконечные, которые считаются временными; в качестве вершины v начала очередной итерации выбирается вершина $x^s$

ШАГ I – *обновление меток*. У всех вершин, достижимых из $v$, обновляются метки согласно правилу:
– если критерий аддитивный, то $$S(x):= \min{\{S(x); S(v)+C(v,u,x) /x = f ( v , u )\}}$$– если критерий вида $\max$, то
$$S(x):= \min{\{S(x); \max{\{S(v); C(v,u,x) /x = f ( v , u )\}\}}}$$
Запоминается входящее в вершину $x$ ребро $g^*(х)$, соответствующее значению минимума: если минимум в том правиле достигается на первом элементе, то $g^*(х)$ не изменяется, в противном случае полагается $g^*(х) = (v,u, x )$.

ШАГ 2 – *получение постоянной метки*. Из всех вершин с временными метками выбирается вершина, имеющая наименьшую временную метку. Эта метка становится постоянной, а соответствующая вершина объявляется вершиной $v$ – началом следующей итерации.

ШАГ 3 – *критерий останова*. Если $v=х^f$, то процесс вычислений останавливается и выполняется переход на шаг 4, иначе – выполняется возврат на шаг 1.

Шаг 4 – *построение пути*. После останова значение метки $S(х^f)$ определяет значение критерия качества оптимального пути, а сам оптимальный путь проводится по отмеченным ребрам (через вершины с постоянными метками).

Для обоснования метода Дейкстры достаточно доказать, что путь, проходящий по отмеченным ребрам в вершину с постоян-ной меткой (назовем ее вершиной $x$), есть оптимальный путь для этой вершины. (Заметим, что путь, построенный методом Дейкстры обязательно проходит только по вершинам с постоян-ными метками).

Для доказательства рассмотрим другие варианты выбора пути в $x$. При этом либо на таких путях все вершины окажутся с постоянными метками, но будут присутствовать непомеченные ребра, либо, встретятся вершины с временными метками. Если все вершины пути имеют постоянные метки, то включение непомеченного ребра (приводящего в нашем случае в вершину с постоянной меткой, — обозначим эту вершину через $у$) не может уменьшить значение критерия качества пути, поскольку при определении метки вершины $у$ вариант прихода в у по этому ребру уже рассматривался и не привел к значению критериев качества перехода меньшему, чем $S(у)$. Итак, вершины с постоянными метками всегда достаточно соединять только по помеченным ребрам. Остается рассмотреть второй случай. Пусть $z$ – первая вершина с временной меткой в рассматриваемом пути $(х^s,х)$, а $(х^s,z)$ часть этого пути до вершины $z$. Поскольку $z$ – первая вершина с временной меткой, то при вычислении $S(z)$ вариант движения по $(x^s,z)$ рассматривался и, следовательно, $S(z) \leq W(\gamma(х^s,z))$, а в силу неотрицательности весов, выполняется: $W(\gamma(х^s,z)) \leq W(\gamma(х^s,x))$. С другой стороны, значение критерия качества пути $\gamma^D(х^s,x)$, построенного по методу Дейкстры, равно постоянной метке $S(х)$, которая меньше или равна временной метки $S(z)$ (напомним, что по правилам построения постоянных меток все они — меньше или равны временных).

Таким образом
$$W(\gamma^D(х^s,x )) = S(x) \leq S(z) \leq W(\gamma(х^s, z)) \leq
W(\gamma(х^s,x)).$$
Отсюда следует, что путь $( х^s ,x )$ не улучшает значение
критерия качества пути по сравнению с путем, построенным
методом Дейкстры. Оптимальность получаемых решений
доказана.

## Задачи на графах с векторными весами ребер. Отыскание оптимальных по Парето и Слейтеру решений методом сверток, согласование вида свертки с видом критерия, основные свойства линейной свертки и свертки Гермейера (использовать материалы лабораторной работы)

Типичной для прикладных задач является ситуация, когда с каждым ребром связывается не одна числовая характеристика, а несколько, образующих векторный вес ребра .
Критерии качества пути (i от 1 до n):
1) Аддитивный
2) Типа max
В общем случае компоненты векторного критерия являются противоречивыми в том смысле, что их минимальные значения достигаются на различных путях.s