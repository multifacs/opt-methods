## Задача о многоступенчатой ракете

Масса - $M$ = 64
Ступеней в ракете - $N$ = 3
Масса капсулы косм. аппарата - $m$ = 1
Вес топлива в ступенях - $u_1, u_2, ..., u_N$
Прирост скорости при отбросе $k$-той ступени -
$$\frac{u_k}{m + u_1 + ... + u_k}$$
### Решение:

Управление: $u_k$ - топливо в $k$-той ступени
Состояние: $x_k$ - нераспределенное топливо
Уравнение состояния: $x_k = x_{k-1}-u_k$

$x_0$ ->($u_1$) $x_1$ ->($u_2$) $x_2$ ->($u_3$) $x_3$
$x_0 = M - m$
$x_1 = f(x_0, u_1) = x_0 - u_1$
$x_2 = x_1 - u_2$

#### Шаг 1-ый

$$S_1(x_2) = \max_{u_3 \in u(x_2)} \frac{u_3}{m + u_3} =^*$$

Приросты скорости после отделения $k$-ых ступеней:
$\Delta_1 = \frac{u_1}{m+u_1+u_2+u_3}$  
$\Delta_2 = \frac{u_2}{m+u_2+u_3}$  
$\Delta_3 = \frac{u_3}{m+u_3}$  
$[\Delta_1+\Delta_2+\Delta_3] \rightarrow \max_{u_1, u_2, u_3}$

$$=^* \max_{0 \leq u_3 \leq x_2} \frac{u_3}{m + x_2} = \frac{x_2}{m + x_2}$$при $u_3^*(x_2)=x_2$

#### Шаг 2-ой

$${
S_2(x_1)=\max_{u_2 \in u(x_1)}\{S_1(x_2) + \Delta_2\} =
\max_{0 \leq u_2 \leq x_1} \{S_1(x_1-u_2) + \frac{u_2}{m+u_2+u_3}\}
=^*
}$$
Замены:
$${
x_0 = u_1 + u_2 + u_3
x_1 = u_2 + u_3
x_2 = u_3
}$$
$${
=^* \max_{0 \leq u_2 \leq x_1} \{\frac{x_1-u_2}{m+x_1-u_2} + \frac{u_2}{m+x_1}\}^{=f(u_2)} =^*
}$$
$${
f'(u_2) = \frac{m^2+x_1^2+u^2_2+2mx_1-2xu_2-2mu_2-m^2-mx_1}{(m+x_1)(m+x_1-u^2)^2}=0
}$$
$${
\cancel{m^2}+\underline{x_1}^2+\underline{u^2_2}+\overline{2mx_1}-2xu_2-2mu_2-\cancel{m^2}-\overline{mx_1}=0
}$$
$${
x_1^2+u^2_2+mx_1-\underline{2xu_2}-\underline{2mu_2}=0
}$$
Получили квадратное уравнение:
$${
u^2_2 - 2u_2(2x_1 + m) + x_1(x_1+m)=0
}$$
$${
\underline{u_2^*(x_1)=m+x_1-\sqrt{\frac{m}{m+x_1}}}
}$$
$${
=^* ... = 2(1 - \sqrt{\frac{m}{m+x_1}})
}$$

#### Шаг 3-ий

$${
S_3(x_0)=\max_{0 \leq u_1 \leq x_0 \leq 63} \{\frac{u_1}{m+x_0} + S_2(x_1)\} =
}$$
$${
 = \max_{0 \leq u_1 \leq x_0} \{\frac{u_1}{m+x_0} + 2(1 - \sqrt{\frac{m}{m+x_1}})\}
}$$
$${
(f(u_1) \rightarrow \max, f'(u_1) = 0, u^*_1(x_0)=...)
}$$
$${
\underline{u_1^*(x_0)=(m+x_0)-m^{\frac{1}{3}}(m+x_0)^{\frac{2}{3}}=48}
}$$
$${
x^*_1 = 15, u^*_2=12
}$$
$${
x^*_2 = 3, u^*_2=3
}$$

### Ответ:

$(48, 12, 3)$
